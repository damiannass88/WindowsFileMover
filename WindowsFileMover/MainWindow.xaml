<Window x:Class="WindowsFileMover.MainWindow"
        xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
        xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
        mc:Ignorable="d"
        Title="Windows File Mover" Height="1020" Width="1400">
    <DockPanel>

        

        <!-- TOP BAR -->
        <!-- TOP BAR (actions + filters) -->
        <Border DockPanel.Dock="Top"
        Padding="10"
        BorderThickness="0,0,0,1"
        BorderBrush="#DDD"
        Background="#F7F7F7">

            <Grid>
                <Grid.RowDefinitions>
                    <RowDefinition Height="Auto"/>
                    <RowDefinition Height="Auto"/>
                </Grid.RowDefinitions>

                <!-- ROW 1: ACTIONS -->
                <WrapPanel VerticalAlignment="Center" Margin="0,0,0,6">

                    <Button Content="Choose Source folder…"
                    Command="{Binding PickSourceCommand}"
                    Padding="10,6"
                    Margin="0,0,4,0"/>

                    <Button Content="Choose Destination…"
                    Command="{Binding PickDestinationCommand}"
                    Padding="10,6"
                    Margin="0,0,16,0"/>

                    <Button Content="Search Files"
                    Command="{Binding SearchCommand}"
                    Padding="14,6"
                    Margin="0,0,8,0"/>

                    <Button Content="Move selected"
                    Command="{Binding MoveCommand}"
                    Padding="14,6"
                    Margin="0,0,16,0"/>

                    <Button Content="Select all"
                    Command="{Binding SelectAllCommand}"
                    Padding="10,6"
                    Margin="0,0,4,0"/>

                    <Button Content="Select none"
                    Command="{Binding SelectNoneCommand}"
                    Padding="10,6"
                    Margin="0,0,16,0"/>

                    <Button Content="Reset"
                            Command="{Binding ResetCommand}"
                            Padding="10,6"
                            Margin="11,0,20,0"/>

                    <CheckBox Content="Keep folder structure (from source)"
                      IsChecked="{Binding KeepStructure}"
                      Margin="0,0,12,0"/>

                    <CheckBox Content="Auto-rename on conflict moving"
                      IsChecked="{Binding AutoRenameOnConflict}"/>

                </WrapPanel>

                <!-- ROW 2: FILTERS -->
                <WrapPanel Grid.Row="1" VerticalAlignment="Center">

                    <TextBlock Text="Search with word:"
                       VerticalAlignment="Center"
                       Margin="0,0,6,0"/>

                    <TextBox Width="200"
                     Text="{Binding WithWord, UpdateSourceTrigger=PropertyChanged}"
                     Margin="0,0,16,0"/>

                    <TextBlock Text="Extensions:"
                       VerticalAlignment="Center"
                       Margin="0,0,6,0"/>

                    <CheckBox Content="mp4" IsChecked="{Binding ExtMp4}" Margin="0,0,6,0"/>
                    <CheckBox Content="mkv" IsChecked="{Binding ExtMkv}" Margin="0,0,6,0"/>
                    <CheckBox Content="avi" IsChecked="{Binding ExtAvi}" Margin="0,0,6,0"/>
                    <CheckBox Content="mov" IsChecked="{Binding ExtMov}" Margin="0,0,6,0"/>
                    <CheckBox Content="wmv" IsChecked="{Binding ExtWmv}" Margin="0,0,6,0"/>
                    <CheckBox Content="flv" IsChecked="{Binding ExtFlv}" Margin="0,0,6,0"/>
                    <CheckBox Content="webm" IsChecked="{Binding ExtWebm}" Margin="0,0,12,0"/>

                    <TextBlock Text="Custom extensions:"
                       VerticalAlignment="Center"
                       Margin="0,0,6,0"/>

                    <TextBox Width="220"
                     Text="{Binding CustomExtensions, UpdateSourceTrigger=PropertyChanged}"
                     ToolTip="Comma or space separated (e.g. m4v, ts, mts)"/>
                </WrapPanel>
            </Grid>
        </Border>


        <!-- PROGRESS -->
        <Border DockPanel.Dock="Top" Padding="10" BorderThickness="0,0,0,1" BorderBrush="#EEE">
            <StackPanel>
                <ProgressBar Height="14"
                             Minimum="0"
                             Maximum="{Binding ProgressMax}"
                             Value="{Binding ProgressValue}"/>
                <TextBlock Margin="0,6,0,0" Text="{Binding ProgressText}"/>
            </StackPanel>
        </Border>

        <Border DockPanel.Dock="Bottom" Padding="10" BorderThickness="0,1,0,0" BorderBrush="#DDD" Background="#F7F7F7">
            <TextBlock Text="{Binding Status}" FontWeight="SemiBold"/>
        </Border>

        <!-- GRID -->
        <DataGrid ItemsSource="{Binding Files}"
                  AutoGenerateColumns="False"
                  CanUserAddRows="False"
                  IsReadOnly="False"
                  SelectionMode="Extended"
                  SelectionUnit="Cell"
                  Margin="10"
                  GridLinesVisibility="Horizontal"
                  HeadersVisibility="Column">

            <DataGrid.Resources>
                <Style x:Key="LargeFileCheckBox" TargetType="CheckBox">
                    <Setter Property="Width" Value="32"/>
                    <Setter Property="Height" Value="20"/>
                    <Setter Property="FontSize" Value="16"/>
                    <Setter Property="HorizontalAlignment" Value="Center"/>
                    <Setter Property="VerticalAlignment" Value="Center"/>
                    <Setter Property="Margin" Value="6,0"/>
                    <Setter Property="FocusVisualStyle" Value="{x:Null}"/>
                    <Setter Property="Focusable" Value="False"/>
                </Style>
            </DataGrid.Resources>

            <DataGrid.RowStyle>
                <Style TargetType="DataGridRow">
                    <Setter Property="FocusVisualStyle" Value="{x:Null}"/>
                    <Setter Property="Background" Value="Transparent"/>
                    <Setter Property="BorderThickness" Value="0"/>
                    <Style.Triggers>
                        <Trigger Property="IsSelected" Value="True">
                            <Setter Property="Background" Value="Transparent"/>
                        </Trigger>
                        <Trigger Property="IsMouseOver" Value="True">
                            <Setter Property="Background" Value="Transparent"/>
                        </Trigger>
                    </Style.Triggers>
                </Style>
            </DataGrid.RowStyle>

            <DataGrid.Columns>
                <DataGridCheckBoxColumn Header="✔"
                                    Width="70"
                                    Binding="{Binding IsSelected, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}"
                                    ElementStyle="{StaticResource LargeFileCheckBox}"
                                    EditingElementStyle="{StaticResource LargeFileCheckBox}">
                <DataGridCheckBoxColumn.HeaderStyle>
                    <Style TargetType="DataGridColumnHeader">
                        <Setter Property="HorizontalContentAlignment" Value="Center"/>
                        <Setter Property="VerticalContentAlignment" Value="Center"/>
                    </Style>
                </DataGridCheckBoxColumn.HeaderStyle>
            </DataGridCheckBoxColumn>

                <DataGridTextColumn Header="Name" Binding="{Binding Name}" Width="2*"/>
                <DataGridTextColumn Header="Size" Binding="{Binding SizeHuman}" Width="120"/>
                <DataGridTemplateColumn Header="Open file" Width="110">
                    <DataGridTemplateColumn.CellTemplate>
                        <DataTemplate>
                            <Button Content="Open"
                                    Padding="6,2"
                                    Margin="0,0,0,0"
                                    HorizontalAlignment="Center"
                                    Command="{Binding DataContext.OpenFileCommand, RelativeSource={RelativeSource AncestorType=Window}}"
                                    CommandParameter="{Binding}"/>
                        </DataTemplate>
                    </DataGridTemplateColumn.CellTemplate>
                </DataGridTemplateColumn>
                <DataGridCheckBoxColumn Header="Move with Folder"
                                        Width="130"
                                        Binding="{Binding MoveWithFolder, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}"
                                        ElementStyle="{StaticResource LargeFileCheckBox}"
                                        EditingElementStyle="{StaticResource LargeFileCheckBox}">
                    <DataGridCheckBoxColumn.HeaderStyle>
                        <Style TargetType="DataGridColumnHeader">
                            <Setter Property="HorizontalContentAlignment" Value="Center"/>
                            <Setter Property="VerticalContentAlignment" Value="Center"/>
                        </Style>
                    </DataGridCheckBoxColumn.HeaderStyle>
                </DataGridCheckBoxColumn>
                 <DataGridTextColumn Header="Full path" Binding="{Binding FullPath}" Width="4*"/>
            </DataGrid.Columns>
        </DataGrid>
    </DockPanel>
</Window>
